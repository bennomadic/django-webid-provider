{% extends "django_webid/provider/base.html" %}

{% load i18n %}
{% load uni_form_tags %}


{% block head_title %}{% blocktrans %}WebID Cert Details{% endblocktrans %}{% endblock %}

{% block extra_head %}
{% endblock %}

{% block body %}

{% if messages %}
    <ul id="messages">
        {% for message in messages %}
        <li id="message_{{ forloop.counter }}">{{message}}</li>
        {% endfor %}
    </ul>
{% endif %}

<div class="middle_panel">

    <h1>{% trans "WebID Certificate Details" %}</h1>
    {% if not object.pubkey.is_active %}
    <h2 class="error">The Public Key contained on this Certificate has been revoked. You cannot use it for login anywhere.</h2>
    {% endif %}

    <p>Sha1 Fingerprint: {{ object.fingerprint_sha1 }}</p>
    <p>Valid From: {{object.valid_from}}</p>
    <p>Valid Until: {{object.expires}}</p>

    <h2>Public Key on this Certificate</h2>
    <p>Bits: {{object.pubkey.bits}}</p>
    <p>Modulus: {{object.pubkey.mod}}</p>
    <p>Exponent: {{object.pubkey.exp}}</p>

    {% if object.pubkey.is_active %}
    <div class="cert_revoke_link">
	    <a href="{% url webidprovider-cert-revoke cert_id=object.id %}">Revoke this cert</a>
    </div>
    {% endif %}
</div>

{% endblock %}

{% block extra_body %}
{% endblock %}

